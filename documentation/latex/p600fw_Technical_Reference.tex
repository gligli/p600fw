\documentclass[draft,landscape, 11pt, oneside]{report}
\usepackage[a4paper, left=2cm, right=2cm, top=2.5cm]{geometry}
%\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{hyperref}
\usepackage{titlesec}
\usepackage{scrextend}
\usepackage{array}
%\usepackage{fontspec}
\usepackage[inline]{showlabels}
%\setmainfont{FiraSans-SemiBold}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}
\setlength{\leftmargin}{-4cm}
\setlength{\paperheight}{210mm}
\setlength{\paperwidth}{297mm}
\setlength{\textwidth}{26cm}
\setlength{\footskip}{2.5cm}
\renewcommand{\familydefault}{\sfdefault}

\newenvironment{flowtext}{\addmargin[0cm]{7cm}}{\endaddmargin} % standard text width (reduced for layout)

\title{[DRAFT] Technical Reference for the GliGli upgraded Prophet 600}
\author{Florian Merz (Editor)}
\pagestyle{myheadings}\markright{[DRAFT]  Technical Reference for the GliGli upgraded Prophet 600}
\makeatletter
\renewcommand\chapter{\pagestyle{myheadings}\markright{[DRAFT]  Technical Reference for the GliGli upgraded Prophet 600}\global\@topnum\z@\@afterindentfalse\secdef\@chapter\@schapter}
\makeatother
\titleformat{\chapter}[display]{\pagebreak\LARGE\bfseries}{}{0.0cm}{}
\titlespacing{\chapter}{0pt}{*0}{*0}
%\titleformat{\section}[display]{\Large\bfseries}{}{0.0cm}{}
\titlespacing{\section}{0pt}{*0}{*0}

\begin{document}

%\maketitle
\tableofcontents


\pagebreak

\chapter{Overview of technical implementation}

\begin{flowtext}
The Teensy++ 2.0 hardware uses a memory which is structured in 512 pages with 256 bytes each.

(this needs to be done)
\end{flowtext}

\chapter{Implementation}

\begin{flowtext}

\section{Memory usage}\label{memory}

\include{memory.tex}

\section{SysEx structure}\label{sysex}

\include{sysex.tex}

\end{flowtext}

\chapter{Firmware structure}

(this needs to be done)

\section{Timer interrupt}\label{timeinterrupt}

\section{UART interrupt}\label{uartinterrupt}

\section{Multiplexer / DAC}\label{potmux}

\section{Mix and Drive vs. Volume A and Volum B}

\textbf{Mapping from mix and drive to volumes} 

When $drive\leq 1/2$:
\begin{eqnarray}
VolA=2\times drive \times (1-mix) \\
VolB=2\times drive \times mix 
\end{eqnarray}

When $drive> 1/2$ and $mix \leq 1/2$:
\begin{eqnarray}
VolA=1-2\times mix \times (1-drive) \\
VolB=2\times mix \times drive 
\end{eqnarray}

When $drive> 1/2$ and $mix > 1/2$:
\begin{eqnarray}
VolA=2\times drive \times (1-mix) \\
VolB=1-2\times (1-mix) \times (1-drive) 
\end{eqnarray}

\textbf{Mapping from volumes to mix and drive} 

When $VolA+VolB\leq 1$:
\begin{eqnarray}
  mix=\frac{VolB}{VolA+VolB} \\
  drive=\frac{VolA+VolB}{2} 
\end{eqnarray}

When $VolA+VolB>1$ then $mix = (1+VolB-VolA)/2$ and
\begin{eqnarray}
  VolA \geq VolB \to drive=\frac{VolB}{1+VolB-VolA} \\
  VolA < VolB \to drive=\frac{VolA}{1+VolA-VolB}
\end{eqnarray}

It is important to manage the singularities at $VolA=0$ and $VolB=0$. The following solution is chosen. In the regime $VolA+VolB>1$ the smaller of the two volumes is cut-off at a small value so that the denominator is well behaved.


\begin{thebibliography}{50} 

\bibitem{gligli}GliGli Projects Page, http://gliglisynth.blogspot.com/
\bibitem{curtis}Curtis Electro Music on Webarchive, https://web.archive.org/web/20130502132536/http://curtiselectromusic.com/Customers\_and\_Instruments.html
\bibitem{versiontwo}GliGli upgrade release 2.0,  https://gligli.github.io/p600fw/
\bibitem{modinstructions} Prophet600 Modification Instructions
\bibitem{projectsite} Project Site: http://gligli.github.io/p600fw/
\bibitem{repository} Repository: https://github.com/gligli/p600fw/
\bibitem{teensy}Teensy Site: http://www.pjrc.com/teensy/index.html
\bibitem{p600siownersmanual}Prophet 600 Owner's Manual, Sequential Circuits
\bibitem{p600siservicemanual} Prophet 600 Service Manual, Sequential Circuits

\end{thebibliography}

\end{document}
